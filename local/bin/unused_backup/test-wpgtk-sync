#!/bin/bash

# Script para probar la sincronizaciÃ³n automÃ¡tica de wpgtk con pywal

echo "ðŸ§ª Probando sincronizaciÃ³n de wpgtk con pywal..."

# Lista de wallpapers disponibles
WALLPAPERS=(
    "$HOME/Pictures/Wallpapers/1.jpg"
    "$HOME/Pictures/Wallpapers/2.jpg" 
    "$HOME/Pictures/Wallpapers/3.jpg"
)

for wallpaper in "${WALLPAPERS[@]}"; do
    if [ -f "$wallpaper" ]; then
        echo
        echo "ðŸ“¸ Probando con wallpaper: $(basename "$wallpaper")"
        
        # Cambiar wallpaper con pywal
        wal -i "$wallpaper" >/dev/null 2>&1
        
        # Esperar un poco para que se ejecuten los hooks
        echo "â³ Esperando sincronizaciÃ³n..."
        sleep 5
        
        # Verificar sincronizaciÃ³n
        current_pywal=$(basename "$(cat ~/.cache/wal/wal)")
        current_wpgtk=$(wpg -c 2>/dev/null)
        
        echo "ðŸŽ¨ Pywal actual: $current_pywal"
        echo "ðŸŽ¨ wpgtk actual: $current_wpgtk"
        
        if [ "$current_pywal" = "$current_wpgtk" ]; then
            echo "âœ… SincronizaciÃ³n exitosa"
        else
            echo "âŒ SincronizaciÃ³n fallida - ejecutando manualmente..."
            bash ~/.cache/wal/wpgtk-sync-hook.sh
            current_wpgtk=$(wpg -c 2>/dev/null)
            echo "ðŸŽ¨ wpgtk despuÃ©s del hook manual: $current_wpgtk"
        fi
        
        sleep 2
    fi
done

echo
echo "ðŸ“‹ Estado final de wpgtk:"
wpg -l
echo
echo "ðŸŽ¯ Wallpaper activo en wpgtk: $(wpg -c)"
echo "ðŸŽ¯ Wallpaper activo en pywal: $(basename "$(cat ~/.cache/wal/wal)")"

echo
echo "ðŸŽ‰ Prueba completada"
