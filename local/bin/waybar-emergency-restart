#!/bin/bash

# Script de emergencia para reiniciar Waybar cuando sea necesario
# Uso: waybar-emergency-restart

echo "ðŸš¨ REINICIO DE EMERGENCIA DE WAYBAR"

# Matar todos los procesos de waybar (incluso los colgados)
echo "â¹ï¸ Terminando waybar..."
pkill -9 waybar 2>/dev/null || true

# Esperar un momento
sleep 1

# Verificar que no quede ningÃºn proceso
if pgrep waybar > /dev/null; then
    echo "ðŸ”¨ AÃºn hay procesos waybar, forzando terminaciÃ³n..."
    pkill -9 waybar
    sleep 0.5
fi

# Iniciar waybar limpio
echo "ðŸš€ Iniciando waybar..."
waybar > /dev/null 2>&1 &

# Verificar que se iniciÃ³
sleep 1.5

if pgrep waybar > /dev/null; then
    echo "âœ… Waybar reiniciado exitosamente"
    notify-send "ðŸš¨ Waybar Emergency" "Reiniciado exitosamente" -t 3000 2>/dev/null || true
else
    echo "âŒ ERROR: No se pudo reiniciar waybar"
    notify-send "âŒ ERROR Waybar" "No se pudo reiniciar" -u critical 2>/dev/null || true
    exit 1
fi

echo "ðŸŽ‰ Reinicio de emergencia completado"
