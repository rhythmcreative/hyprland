#!/bin/bash

# Script de prueba para verificar sincronizaci√≥n waybar-pywal

echo "üß™ Probando sincronizaci√≥n waybar-pywal..."

# Verificar que waybar est√© corriendo
if ! pgrep -x waybar > /dev/null; then
    echo "‚ùå Waybar no est√° corriendo"
    exit 1
fi

# Verificar archivos de pywal
if [[ ! -f "$HOME/.cache/wal/colors.sh" ]]; then
    echo "‚ùå No se encontraron colores de pywal"
    echo "üí° Ejecuta 'wal -i /path/to/image' primero"
    exit 1
fi

# Mostrar wallpaper actual
current_wallpaper=$(cat ~/.cache/current-wallpaper 2>/dev/null || echo "No definido")
echo "üñºÔ∏è Wallpaper actual: $current_wallpaper"

# Mostrar colores de pywal actuales
source "$HOME/.cache/wal/colors.sh"
echo "üé® Colores pywal actuales:"
echo "   Background: $background"
echo "   Foreground: $foreground"
echo "   Color4 (azul): $color4"

# Verificar archivo de colores waybar
if [[ -f "$HOME/.config/waybar/colors-pywal.css" ]]; then
    echo "‚úÖ Archivo colors-pywal.css existe"
    # Mostrar primera l√≠nea con fecha
    first_line=$(head -1 "$HOME/.config/waybar/colors-pywal.css")
    echo "   $first_line"
else
    echo "‚ùå Archivo colors-pywal.css no existe"
fi

# Probar sincronizaci√≥n manual
echo ""
echo "üîÑ Ejecutando sincronizaci√≥n manual..."
~/.local/bin/waybar-pywal-sync

echo ""
echo "‚úÖ Prueba completada. Verifica que waybar refleje los colores correctos."
