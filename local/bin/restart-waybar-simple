#!/bin/bash

# Script simple para reiniciar waybar cuando se necesite
# Ãštil como alternativa rÃ¡pida cuando waybar se cierra inesperadamente

echo "ğŸ”„ Reiniciando waybar..."

# Matar procesos existentes de waybar
if pgrep -x waybar > /dev/null; then
    echo "â¹ï¸ Deteniendo waybar existente..."
    pkill waybar
    sleep 1
fi

# Verificar que se detuvo
remaining=$(pgrep -x waybar || true)
if [[ -n "$remaining" ]]; then
    echo "ğŸ”¨ Forzando cierre de waybar..."
    pkill -9 waybar
    sleep 0.5
fi

# Iniciar waybar
echo "ğŸš€ Iniciando waybar..."
waybar > /dev/null 2>&1 &

# Verificar que se iniciÃ³ correctamente
sleep 1
if pgrep -x waybar > /dev/null; then
    echo "âœ… Waybar iniciado correctamente"
    notify-send "ğŸ¨ Waybar Reiniciado" "Waybar iniciado correctamente" -t 2000 2>/dev/null || true
else
    echo "âŒ ERROR: No se pudo iniciar waybar"
    notify-send "âŒ Error Waybar" "No se pudo iniciar waybar" -u critical 2>/dev/null || true
    exit 1
fi

echo "ğŸ‰ Waybar reiniciado exitosamente"
