#!/bin/bash
# Script para cambiar temas de Oh My Posh
# Uso: posh-theme [nombre-del-tema]

THEMES_DIR="$HOME/.cache/oh-my-posh/themes"
BASHRC="$HOME/.bashrc"

if [ $# -eq 0 ]; then
    echo "๐จ Temas disponibles de Oh My Posh:"
    echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
    ls "$THEMES_DIR" | sed 's/.omp.json//' | column -c 80
    echo ""
    echo "๐ Uso: posh-theme [nombre-del-tema]"
    echo "๐ก Ejemplos populares:"
    echo "   โข posh-theme custom              (โจ TEMA PERSONALIZADO โจ)"
    echo "   โข posh-theme catppuccin_mocha    (oscuro, elegante)"
    echo "   โข posh-theme tokyonight_storm    (azul, moderno)"
    echo "   โข posh-theme dracula             (morado, clรกsico)"
    echo "   โข posh-theme bubbles             (colorido, divertido)"
    echo "   โข posh-theme atomic              (minimalista)"
    exit 0
fi

THEME_NAME="$1"
THEME_FILE="$THEMES_DIR/${THEME_NAME}.omp.json"

if [ ! -f "$THEME_FILE" ]; then
    echo "โ Tema '$THEME_NAME' no encontrado."
    echo "๐ Temas disponibles:"
    ls "$THEMES_DIR" | sed 's/.omp.json//' | head -10
    echo "..."
    echo "๐ก Usa 'posh-theme' sin argumentos para ver todos los temas."
    exit 1
fi

# Actualizar .bashrc con el nuevo tema
sed -i "s|eval \"\$(~/bin/oh-my-posh init bash --config .*\.omp\.json)\"|eval \"\$(~/bin/oh-my-posh init bash --config $THEME_FILE)\"|" "$BASHRC"

echo "โ Tema '$THEME_NAME' aplicado exitosamente!"
echo "๐ Reinicia tu terminal o ejecuta: source ~/.bashrc"
echo ""
echo "๐จ Vista previa del tema:"
eval "$(~/bin/oh-my-posh init bash --config "$THEME_FILE")"
