#!/bin/bash

# Script espec칤fico para lanzar nm-applet con tema personalizado de pywal
# Este script NO modifica la configuraci칩n global de GTK

# Cargar colores de pywal
if [ -f "$HOME/.cache/wal/colors.sh" ]; then
    source "$HOME/.cache/wal/colors.sh"
else
    echo "Error: No se encontraron los colores de pywal"
    exit 1
fi

# Directorio del tema
GTK_THEME_DIR="$HOME/.local/share/themes/PywalNMApplet"

# Asegurar que el tema existe
if [ ! -d "$GTK_THEME_DIR" ]; then
    echo "Tema no encontrado, cre치ndolo..."
    "$HOME/.local/bin/nm-applet-theme-sync"
fi

# Configurar variables de entorno espec칤ficamente para nm-applet
export GTK_THEME="PywalNMApplet"
export GTK_USE_PORTAL=1
export GDK_BACKEND=wayland,x11
export GTK2_RC_FILES="$GTK_THEME_DIR/gtk-2.0/gtkrc"

# Imprimir informaci칩n de debug
echo "游 Iniciando nm-applet con tema personalizado..."
echo "   Tema GTK: $GTK_THEME"
echo "   Directorio del tema: $GTK_THEME_DIR"
echo "   Colores: Fondo=$color0, Texto=$color7"

# Verificar si nm-applet ya est치 corriendo
if pgrep -f nm-applet > /dev/null; then
    echo "丘멆잺  nm-applet ya est치 corriendo, termin치ndolo..."
    pkill -TERM nm-applet 2>/dev/null || true
    sleep 1
    pkill -KILL nm-applet 2>/dev/null || true
    sleep 1
fi

# Lanzar nm-applet con las variables de entorno correctas
echo "游댃 Iniciando nm-applet..."
exec nm-applet
