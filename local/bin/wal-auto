#!/bin/bash

# Wrapper para pywal con sincronizaci√≥n autom√°tica de nm-applet y wal-gtk-auto
# Uso: wal-auto -i /path/to/wallpaper [opciones adicionales de wal]

echo "üé® WAL-AUTO: Wrapper con sincronizaci√≥n autom√°tica (nm-applet + wal-gtk-auto)"

# Verificar que pywal est√© instalado
if ! command -v wal > /dev/null 2>&1; then
    echo "‚ùå Error: pywal no est√° instalado"
    exit 1
fi

# Verificar argumentos
if [[ $# -eq 0 ]]; then
    echo "Uso: wal-auto -i /path/to/wallpaper [opciones]"
    echo "O simplemente: wal-auto [argumentos de wal]"
    exit 1
fi

# Ejecutar pywal con los argumentos proporcionados
echo "üöÄ Ejecutando pywal..."
if wal "$@"; then
    echo "‚úÖ pywal completado exitosamente"
    
    # Ejecutar hook de wal-gtk-auto
    if [[ -x "$HOME/.cache/wal/wal-gtk-auto-hook.sh" ]]; then
        echo "üé® Sincronizando tema wal-gtk-auto..."
        "$HOME/.cache/wal/wal-gtk-auto-hook.sh"
    else
        echo "‚ö†Ô∏è  Hook wal-gtk-auto no encontrado o no ejecutable"
    fi
    
    # Ejecutar nuestro post-script
    if [[ -x "$HOME/.config/wal/post.sh" ]]; then
        echo "üîß Ejecutando post-procesamiento..."
        "$HOME/.config/wal/post.sh"
    else
        echo "‚ö†Ô∏è  Post-script no encontrado o no ejecutable"
    fi
    
    echo "üéâ wal-auto completado!"
else
    echo "‚ùå Error: pywal fall√≥"
    exit 1
fi
